# -*- coding: utf-8 -*-
"""データと数理第4回課題 1922068 玉川夏生

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1r0D_mr0fzOQJqGNmNF-mRLHHYUVXXKZ4
"""

from google.colab import drive
drive.mount('/content/drive')

from PIL import Image
import numpy as np
import os

# filepathで指定した画像ファイルを読み込み、その画像のRGB値の平均をNumpyのArrayで【行ベクトルで】返す関数　ext_mean_rgb(filepath)
def ext_mean_rgb(filepath):
  image = np.array(Image.open(filepath).convert('RGB')).reshape(-1,3)
  return np.array([np.mean(image[:,0]),np.mean(image[:,1]),np.mean(image[:,0])])

import numpy as np
from scipy.spatial import distance

# RGB値をnumpy array、qcolor=np.array([r,g,b])で与えられると[赤,橙,黄,緑,青,紫,ピンク,白,グレー,黒]の重みを成分とする10次元ベクトルが出力される関数gen_color_vec(qcolor)
def gen_color_vec(qcolor):
  colorvec=np.array([])
  palette=np.array(
      [
       [255,0,0], #赤
      [255,102,0],  #橙
      [255,255,0],  #黄
      [0,128,0],  #緑
      [0,0,255],  #青
      [128,0,128],  #紫
      [255,0,255],  #ピンク
      [255,255,255],  #白
      [128,128,128],  #グレー
      [0,0,0] #黒
      ])
  for col in palette:
    colorvec=np.append(colorvec,distance.euclidean(col,qcolor))
  colorvec=1-colorvec/np.linalg.norm(colorvec,np.inf)
  return colorvec

#ここを作成
def color_image(x):
  #サイトを参考に自分で印象語を設定
  impression=np.array([['熱い'],['強い'],['危険'],['怖い'],['派手'],['情熱'],['明るい'],['元気'],['興奮'],['暖かい'],['希望'],['可愛い'],['楽しい'],['喜び'],['幸福'],
                       ['輝き'],['未来'],['優しい'],['注意'],['自然'],['安らぎ'],['落ち着き'],['安心'],['平和'],['若々しい'],['冷たい'],['冷静'],['悲しみ'],['涼しい'],
                       ['寒い'],['広大'],['誠実'],['自由'],['高級'],['大人らしい'],['嫉妬'],['不安'],['セクシー'],['神秘的'],['孤独'],['恋愛'],['甘い'],['柔らかい'],
                       ['純粋'],['清潔'],['神聖'],['無'],['綺麗'],['曖昧'],['暗い'],['悩み'],['迷い'],['控えめ'],['疑惑'],['寂しい'],['絶望'],['静寂'],['かっこいい'],['重い']
                       ])
  A=np.array([[1,0,0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1],[1,0,1,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0,0,1],[1,1,1,0,0,0,1,0,0,0],[1,0,0,0,0,0,0,0,0,0],[1,1,1,0,0,0,1,1,0,0],
              [1,1,1,0,0,0,0,0,0,0],[1,0,0,0,0,0,1,0,0,0],[0,1,0,0,0,0,0,0,0,0],[0,1,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,1,0,0,0],[0,1,1,0,0,0,0,0,0,0],[0,1,1,0,0,0,0,0,0,0],
              [0,0,1,0,0,0,1,0,0,0],[0,1,1,0,0,0,0,0,0,0],[0,0,1,0,0,0,0,0,0,0],[0,0,1,1,0,0,1,0,0,0],[0,0,1,0,0,0,0,0,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0,0],
              [0,0,0,1,1,0,0,0,0,0],[0,0,0,1,0,0,0,0,0,0],[0,0,0,1,1,0,0,1,0,0],[0,0,0,1,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0],
              [0,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,1],[0,0,0,1,1,0,0,0,0,0],[0,0,0,0,1,0,0,1,0,0],[0,0,0,0,0,1,0,0,0,1],[0,0,0,0,0,1,0,0,0,0],
              [0,0,0,0,0,1,0,0,0,1],[0,0,0,0,0,1,0,0,1,1],[0,0,0,0,0,1,0,0,0,0],[0,0,0,0,1,0,0,1,0,0],[0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,1,0,0,0],
              [0,0,0,0,0,0,1,1,0,0],[0,0,0,0,0,0,0,1,0,0],[0,0,0,0,1,0,0,1,0,0],[0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,1,0,1],[0,0,0,0,0,0,0,1,0,0],[0,0,0,0,0,0,0,0,1,0],
              [0,0,0,0,0,0,0,0,1,1],[0,0,0,0,0,1,0,0,1,0],[0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,1,0],[0,0,0,0,0,0,0,0,1,0],[0,0,0,0,1,0,0,0,1,0],[0,0,0,0,0,0,0,0,0,1],
              [0,0,0,0,1,0,0,0,0,1],[0,0,0,0,1,0,0,0,0,1],[0,0,0,0,0,0,0,0,0,1]])
  y=np.dot(A,x)
  #一旦listに戻して印象語と一緒にソート
  c=list(zip(y, impression))
  c.sort(reverse=True)
  y, impression=zip(*c)
  new_imp=np.array(impression)
  print(new_imp[:10])

filepath='/content/drive/My Drive/授業用/データと数理 課題用/easy-tips-make-landscape-photography-stand.jpeg'
x=gen_color_vec(ext_mean_rgb(filepath)).reshape(-1,1)
x

#重みが強い順に上位10個の印象語を表示
color_image(x)